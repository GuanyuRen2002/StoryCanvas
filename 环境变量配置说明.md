# 环境变量配置说明

## 📋 配置步骤

### 1. 创建环境变量文件
将 `env_template.txt` 复制并重命名为 `.env`：

```bash
# Windows
copy env_template.txt .env

# Linux/Mac
cp env_template.txt .env
```

### 2. 编辑.env文件
在 `.env` 文件中填入您的真实API密钥：

```env
# OpenAI API配置
OPENAI_API_KEY=sk-your-real-openai-key-here

# Gemini API配置  
GEMINI_API_KEY=your-real-gemini-api-key-here

# Azure语音服务配置（用于故事朗读功能）
SPEECH_API_KEY=your-real-azure-speech-key-here
SPEECH_REGION=eastus

# Flask配置
SECRET_KEY=your-custom-secret-key-here
FLASK_DEBUG=True

# 服务器配置
HOST=0.0.0.0
PORT=5000
```

### 3. 获取API密钥

#### OpenAI API Key
1. 访问 [OpenAI API Keys](https://platform.openai.com/api-keys)
2. 登录您的OpenAI账户
3. 创建新的API密钥
4. 复制密钥并填入.env文件

#### Gemini API Key
1. 访问 [Google AI Studio](https://aistudio.google.com/app/apikey)
2. 创建新的API密钥
3. 复制密钥并填入.env文件

#### Azure Speech Service Key
1. 登录 [Azure Portal](https://portal.azure.com/)
2. 创建Speech Service资源
3. 获取密钥和区域信息
4. 填入.env文件

### 4. 安全注意事项

⚠️ **重要提醒**：
- `.env` 文件包含敏感信息，绝不要提交到版本控制系统
- 已添加到 `.gitignore` 文件中自动忽略
- 不要在代码中硬编码API密钥
- 定期更换API密钥以确保安全

### 5. 验证配置
运行应用时，如果API密钥未正确配置，会显示警告信息：

```
⚠️ 警告：GEMINI_API_KEY 未设置或使用默认值，Gemini功能将不可用
请在.env文件中设置您的Gemini API密钥
```

## 🔧 故障排除

### 问题1：找不到.env文件
- 确保.env文件在项目根目录
- 检查文件名是否正确（以点开头）

### 问题2：API密钥无效
- 验证API密钥是否正确复制
- 检查API密钥是否过期
- 确认API服务账户是否有足够权限

### 问题3：环境变量未加载
- 确保安装了python-dotenv库：`pip install python-dotenv`
- 检查.env文件格式是否正确（无多余空格）

## 📁 文件结构
```
TaleCanvas/
├── .env                    # 环境变量文件（用户创建）
├── env_template.txt        # 环境变量模板
├── .gitignore             # 忽略文件列表
├── config.py              # 配置文件
└── 环境变量配置说明.md    # 本文档
```
